<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
  </head>
  <body>

    <div style="padding-top: 50px;"></div>

    <div class="container">

      <div class="row" data-row="1">
          <div class="col-md-3" data-col="1" data-value=0>col</div>
          <div class="col-md-3" data-col="2" data-value=0>col</div>
          <div class="col-md-3" data-col="3" data-value=0>col</div>
          <div class="col-md-3" data-col="4" data-value=0>col</div>
      </div>

      <div class="row" data-row="2">
          <div class="col-md-3" data-col="1" data-value=0>col</div>
          <div class="col-md-3" data-col="2" data-value=0>col</div>
          <div class="col-md-3" data-col="3" data-value=0>col</div>
          <div class="col-md-3" data-col="4" data-value=0>col</div>
      </div>

      <div class="row" data-row="3">
          <div class="col-md-3" data-col="1" data-value=0>col</div>
          <div class="col-md-3" data-col="2" data-value=0>col</div>
          <div class="col-md-3" data-col="3" data-value=0>col</div>
          <div class="col-md-3" data-col="4" data-value=0>col</div>
      </div>

      <div class="row" data-row="4">
          <div class="col-md-3" data-col="1" data-value=0>col</div>
          <div class="col-md-3" data-col="2" data-value=0>col</div>
          <div class="col-md-3" data-col="3" data-value=0>col</div>
          <div class="col-md-3" data-col="4" data-value=0>col</div>
      </div>

    </div>    
    

    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/underscore/underscore-min.js"></script>
    <script type="text/javascript">
      $(function() {

        var rowCount = $(".row").length;



        function pickRandCell(num) {

          var emptyCells = $("[data-value=0]"),
              emptyCellsCount = emptyCells.length;

          if (num == undefined) { num = 1; } // set default value if num is undefined

          for(var i = 0; i < num; i++) {

            var randIndex = _.random(0, emptyCellsCount - 1),
                selectedCell = emptyCells.eq(randIndex);

            selectedCell.data("value", 2);
            selectedCell.text(2);
          }
        }

        function initGrid() {
          pickRandCell(2);
        }

        function checkDirection(direction) {
          switch (direction) {
            case 37:
              // console.log("left");
              var gravity = "[data-row]";

              // to be continued, plase also add data-row

              for(var k = 1; k <= 4; k++) {

                var currentRow = $("[data-row=" + k + "]");

                for(var i = 1; i <= 4; i++) {
                  var current = currentRow.find("[data-col=" + i + "]"),
                      currentValue = current.data("value");

                  console.log("current: ", currentValue);

                  for(var j = i + 1; j <= 4; j++) {
                    var next = $("[data-col=" + j + "]"),
                        nextValue = next.data("value");

                    if (currentValue == nextValue) {
                      // add both value and set to current node
                      var addResult = currentValue + nextValue;

                      current.data("value", addResult);
                      current.text(addResult);

                      next.data("value", 0);
                      next.text(0);
                    } else if (currentValue == 0 && currentValue < nextValue) {

                      current.data("value", nextValue);
                      current.text(nextValue);

                      next.data("value", 0);
                      next.text(0);
                    }

                    console.log("next: ", nextValue);

                  } // end for loop 'j' 

                  // console.log("Shift i: ", i, " to the left");
                  // moveToLeft()


                } // end for loop 'i'

              } // end for loop 'k'

              pickRandCell();


              break;
            case 39:
              // console.log("right");
               

              break;
            case 38:
              console.log("up");
              break;
            case 40:
              console.log("down");
              break;
            default:
              break;
          }
        }

        $('html').on('keyup', function(e) {
          checkDirection(e.which);
        });

        initGrid();
      });
    </script>
  </body>
</html>
